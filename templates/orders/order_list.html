{% extends 'base.html' %}

{% block title %}Orders{% endblock %}

{% block content %}
    <div class="container">
        {% if owner_mode %}
            <h1 class="mb-3">Orders for Your Restaurants</h1>
        {% elif courier_mode %}
            <h1 class="mb-3">Orders to Deliver</h1>
        {% else %}
            <h1 class="mb-3">My Orders</h1>
        {% endif %}

        {% if orders %}
            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Restaurant</th>
                    <th>User</th>
                    <th>Status</th>
                    <th>Total</th>
                    <th>Placed</th>

                    {% if not owner_mode and not courier_mode %}
                        <th>Track</th>
                    {% endif %}
                </tr>
                </thead>

                <tbody>
                {% for order in orders %}
                    <tr>
                        <td>#{{ order.id }}</td>
                        <td>{{ order.restaurant.name }}</td>
                        <td>{{ order.user.username }}</td>
                        <td>{{ order.get_status_display }}</td>
                        <td>${{ order.total }}</td>
                        <td>{{ order.created_at|date:'Y-m-d H:i' }}</td>

                        {% if not owner_mode and not courier_mode %}
                            <td>
                                {# покажи копче за сите што НЕ се Pending #}
                                {% if order.status != 'PENDING' %}
                                    <a href="{% url 'orders:track_order' order.id %}"
                                       class="btn btn-sm btn-outline-primary">
                                        Track
                                    </a>
                                {% else %}
                                    <span class="text-muted">—</span>
                                {% endif %}
                            </td>
                        {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No orders found.</p>
        {% endif %}
    </div>
{% endblock %}
